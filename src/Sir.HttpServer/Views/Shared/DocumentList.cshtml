@model IEnumerable<Sir.HttpServer.Controllers.SearchResultModel>
@{
    var displayQ = ViewData["qf"] ?? ViewData["q"];

    IList<Sir.HttpServer.Controllers.SearchResultModel> docs = Model == null ?
        new Sir.HttpServer.Controllers.SearchResultModel[0].ToList() : Model.ToList();

    var jsonDownloadLink = $"{Context.Request.Path.Value.ToLower().Replace("/search", "/query")}{Context.Request.QueryString}";
    var crawlLink = $"{Context.Request.Path.Value.ToLower().Replace("/search", "/crawl")}{Context.Request.QueryString}";
}
<h3 class="querystats">@docs.Count results of @ViewData["total"] for <span class="querystats">@displayQ</span> in @ViewData["time_ms"] ms</h3>
@if (docs.Count > 0)
{
    <div class="download-json-result">Download result as <a href="@jsonDownloadLink" title="Use a HTTP client to GET result as Content-Type application/json">JSON</a> or <a href="@crawlLink">crawl</a>.</div>
    <div class="result-list">
        <ol>
            @foreach (var item in docs)
            {
                var url = item.Document["url"].ToString();
                var prefix = url.StartsWith("http") ? string.Empty : "https://";
                var uri = new Uri(prefix + url);
                var host = uri.Host.ToString();
                var title = item.Document.ContainsKey("title") ? item.Document["title"].ToString() : "Unknown title";
                var score = (double)item.Document["___score"];
                var warcFilename = (string)item.Document["filename"];
                var wetFileName = warcFilename.Replace("/warc", "/wet").Replace(".gz", ".wet.gz");
                <li>
                    <div>
                        <div class="document-header">
                            <span><a class="result-link" href="@Html.Raw(uri.ToString())">@Html.Raw(title)</a></span>
                        </div>
                        <div class="document-body">
                            <span class="medium-text">@Html.Raw(host)</span><br />
                            <span class="medium-text">Score: @score.ToString("N2")%</span><br />
                            <span class="medium-text">
                            <a class="warc-link" href="https://commoncrawl.s3.amazonaws.com/@Html.Raw(warcFilename)">WARC</a> 
                            <a class="warc-link" href="https://commoncrawl.s3.amazonaws.com/@Html.Raw(wetFileName)">WET</a></span>
                        </div>
                    </div>
                </li>
            }
        </ol>
    </div>
}
